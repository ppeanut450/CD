<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
    <link rel="stylesheet" href="_sign_up_page.css">
</head>
<body>
    <!-- <form action="_sign_up_page.jsp" method="post"> -->
        <!-- 회원가입 항목 -->
        <div class="member">
            <!-- 이름 -->
            <b>이름 *</b> 
            <div class="field_name">
                <input type="text" id="user_name" placeholder="이름 입력" onkeyup="validateName(this)">
            </div>
            <span class="error_message" id="su_name_error"></span>

            <!-- 아이디 & 비밀번호 -->
            <b>아이디 *</b> 
            <div class="field_id">
                <input type="text" id="user_id"
                    placeholder="아이디 입력 (6~20자)">
                <button id="idck_btn">중복 확인</button>
            </div>
            <span class="error_message" id="su_id_error"></span>

            <b>비밀번호 *</b> 
            <div class="field_password">
                <input class="userpw" type="password" id="user_pw" 
                    placeholder="비밀번호 입력 (숫자, 특수문자 포함 8~20자)">
            </div>
            <span class="error_message" id="su_pw_error"></span>
            <span class="error_message" id="caps_lock_warning1"></span>

            <b>비밀번호 확인 *</b>
            <div class="field_password_check">
                <input class="userpwck" type="password" id="user_pwck"
                    placeholder="비밀번호 재입력">
            </div>
            <span class="error_message" id="su_pwck_error"></span>
            <span class="error_message" id="caps_lock_warning2"></span>

            <!-- 생년월일 -->
            <b>생년월일</b>
            <div class="field_birth">
                <div class="field_birth_year">
                    <select>
                        <option disabled selected> 출생년도</option>
                        <option value="1940"> 1940년</option>
                        <option value="1941"> 1941년</option>
                        <option value="1942"> 1942년</option>
                        <option value="1943"> 1943년</option>
                        <option value="1944"> 1944년</option>
                        <option value="1945"> 1945년</option>
                        <option value="1946"> 1946년</option>
                        <option value="1947"> 1947년</option>
                        <option value="1948"> 1948년</option>
                        <option value="1949"> 1949년</option>
                        <option value="1950"> 1950년</option>
                        <option value="1951"> 1951년</option>
                        <option value="1952"> 1952년</option>
                        <option value="1953"> 1953년</option>
                        <option value="1954"> 1954년</option>
                        <option value="1955"> 1955년</option>
                        <option value="1956"> 1956년</option>
                        <option value="1957"> 1957년</option>
                        <option value="1958"> 1958년</option>
                        <option value="1959"> 1959년</option>
                        <option value="1960"> 1960년</option>
                        <option value="1961"> 1961년</option>
                        <option value="1962"> 1962년</option>
                        <option value="1963"> 1963년</option>
                        <option value="1964"> 1964년</option>
                        <option value="1965"> 1965년</option>
                        <option value="1966"> 1966년</option>
                        <option value="1967"> 1967년</option>
                        <option value="1968"> 1968년</option>
                        <option value="1969"> 1969년</option>
                        <option value="1970"> 1970년</option>
                        <option value="1971"> 1971년</option>
                        <option value="1972"> 1972년</option>
                        <option value="1973"> 1973년</option>
                        <option value="1974"> 1974년</option>
                        <option value="1975"> 1975년</option>
                        <option value="1976"> 1976년</option>
                        <option value="1977"> 1977년</option>
                        <option value="1978"> 1978년</option>
                        <option value="1979"> 1979년</option>
                        <option value="1980"> 1980년</option>
                        <option value="1981"> 1981년</option>
                        <option value="1982"> 1982년</option>
                        <option value="1983"> 1983년</option>
                        <option value="1984"> 1984년</option>
                        <option value="1985"> 1985년</option>
                        <option value="1986"> 1986년</option>
                        <option value="1987"> 1987년</option>
                        <option value="1988"> 1988년</option>
                        <option value="1989"> 1989년</option>
                        <option value="1990"> 1990년</option>
                        <option value="1991"> 1991년</option>
                        <option value="1992"> 1992년</option>
                        <option value="1993"> 1993년</option>
                        <option value="1994"> 1994년</option>
                        <option value="1995"> 1995년</option>
                        <option value="1996"> 1996년</option>
                        <option value="1997"> 1997년</option>
                        <option value="1998"> 1998년</option>
                        <option value="1999"> 1999년</option>
                        <option value="2000"> 2000년</option>
                        <option value="2001"> 2001년</option>
                        <option value="2002"> 2002년</option>
                        <option value="2003"> 2003년</option>
                        <option value="2004"> 2004년</option>
                        <option value="2005"> 2005년</option>
                        <option value="2006"> 2006년</option>
                        <option value="2007"> 2007년</option>
                        <option value="2008"> 2008년</option>
                        <option value="2009"> 2009년</option>
                        <option value="2010"> 2010년</option>
                        <option value="2011"> 2011년</option>
                        <option value="2012"> 2012년</option>
                        <option value="2013"> 2013년</option>
                        <option value="2014"> 2014년</option>
                        <option value="2015"> 2015년</option>
                        <option value="2016"> 2016년</option>
                        <option value="2017"> 2017년</option>
                        <option value="2018"> 2018년</option>
                        <option value="2019"> 2019년</option>
                        <option value="2020"> 2020년</option>
                        <option value="2021"> 2021년</option>
                        <option value="2022"> 2022년</option>
                        <option value="2023"> 2023년</option>
                    </select>   
                </div>
                
                <div class="field_birth_month">
                    <select>
                        <option disabled selected>월</option>
                        <option value="1">1월</option>
                        <option value="2">2월</option>
                        <option value="3">3월</option>
                        <option value="4">4월</option>
                        <option value="5">5월</option>
                        <option value="6">6월</option>
                        <option value="7">7월</option>
                        <option value="8">8월</option>
                        <option value="9">9월</option>
                        <option value="10">10월</option>
                        <option value="11">11월</option>
                        <option value="12">12월</option>
                    </select>
                </div>

                <div class="field_birth_day">
                    <select>
                        <option disabled selected>일</option>
                        <option value="1">1일</option>
                        <option value="2">2일</option>
                        <option value="3">3일</option>
                        <option value="4">4일</option>
                        <option value="5">5일</option>
                        <option value="6">6일</option>
                        <option value="7">7일</option>
                        <option value="8">8일</option>
                        <option value="9">9일</option>
                        <option value="10">10일</option>
                        <option value="11">11일</option>
                        <option value="12">12일</option>
                        <option value="13">13일</option>
                        <option value="14">14일</option>
                        <option value="15">15일</option>
                        <option value="16">16일</option>
                        <option value="17">17일</option>
                        <option value="18">18일</option>
                        <option value="19">19일</option>
                        <option value="20">20일</option>
                        <option value="21">21일</option>
                        <option value="22">22일</option>
                        <option value="23">23일</option>
                        <option value="24">24일</option>
                        <option value="25">25일</option>
                        <option value="26">26일</option>
                        <option value="27">27일</option>
                        <option value="28">28일</option>
                        <option value="29">29일</option>
                        <option value="30">30일</option>
                        <option value="31">31일</option>
                    </select>
                </div>
                <span class="error_message" id="su_birth_error"></span>
            </div>

            <!-- 이메일 -->
            <b>이메일 *</b>
            <div class="field_email">
                <input type="text" id="user_email" placeholder="이메일 주소"> @
                <input class="field_email_domain_txt" id="email_domain_txt" type="text"/>
                <select class="field_email_domain_option" id="email_domain_option">
                    <option disabled selected>선택</option>
                    <option value="type">직접 입력</option>
                    <option value="naver.com">naver.com</option>
                    <option value="google.com">google.com</option>
                    <option value="hanmail.net">hanmail.net</option>
                    <option value="nate.com">nate.com</option>
                    <option value="kakao.com">kakao.com</option>
                    <option value="korea.com">korea.com</option>
                </select>
            </div>
            <span class="error_message" id="su_email_error"></span>
        
            <!-- 전화번호 -->
            <b>전화번호</b>
            <div class="field_number">
                <div>
                    <input type="text" name="phone" id="user_number" placeholder="휴대폰 번호 입력">
                </div>
            </div>
            <span class="error_message" id="su_number_error"></span>

            <!-- 가입 버튼 -->
            <input type="submit" id="signup_button" value="가입"> </input>
            
            <!-- 가입 취소 버튼 -->
            <input type="button" id="signup_cancel_button" value="취소"> </input>
        </div>
    <!-- </form> -->

    <script>

        function validateName(input) {
            var regex = /^[가-힣]+$/; // 정규식으로 한글만 허용
            var value = input.value;
            if (!regex.test(value)) {
                input.value = value.replace(/[^가-힣]/g, ''); // 한글 이외의 문자 제거
            }
        }
        
        document.getElementById('idck_btn').addEventListener('click', function() {
            var userId = document.getElementById('user_id').value;
        
            // 아이디 중복 확인 로직을 수행합니다.
            var isIdExist = idckExist(userId); // 중복 확인 함수를 호출합니다.
            
            // 아이디 길이 확인
            if (userId.length >= 6 && userId.length <= 20) {
                // 중복 확인 로직 수행
                if (isIdExist) {
                    // 중복된 아이디인 경우 오류 메시지 표시
                    document.getElementById('su_id_error').innerText = '이미 사용 중인 아이디입니다.';
                    document.getElementById('su_id_error').style.color = 'red';
                    document.getElementById('su_id_error').style.display = 'block';
                } else {
                    // 중복되지 않은 아이디인 경우 오류 메시지 숨김
                    document.getElementById('su_id_error').innerText = '사용 가능한 아이디입니다.';
                    document.getElementById('su_id_error').style.color = 'green';
                    document.getElementById('su_id_error').style.display = 'block';
                }
            } else {
                // 아이디 길이 오류 메시지 표시
                document.getElementById('su_id_error').innerText = '6~20자의 영문 소문자와 숫자만 사용 가능합니다.';
                document.getElementById('su_id_error').style.color = 'red';
                document.getElementById('su_id_error').style.display = 'block';
            }
        });

        // 입력 필드의 keypress 이벤트 처리
        document.getElementById('user_id').addEventListener('input', function(event) {
            var input = event.target.value;
            var regex = /^[a-z0-9]+$/; // 영문 소문자와 숫자만 허용하는 정규식
            var errorMessage = document.getElementById('su_id_error');

            if (!regex.test(input)) {
                event.target.value = input.replace(/[^a-z0-9]/g, '');
                errorMessage.innerText = '영문 소문자와 숫자만 입력할 수 있습니다.';
                errorMessage.style.color = 'red';
                errorMessage.style.display = 'block';
            } else {
                errorMessage.style.display = 'none';
            }
        });

        function idckExist(userId) {
            // 중복 확인을 수행하는 로직을 구현합니다.
            // 여기에서는 임의로 예시로 중복 여부를 체크하도록 구현하였습니다.
            var existingUserIds = ['user01', 'user02', 'user03']; // 기존에 존재하는 아이디 목록
            return existingUserIds.includes(userId); // 아이디가 기존 목록에 포함되어 있는지 확인하고 결과를 반환합니다.
        }

        // 비밀번호 입력 시 Caps Lock이 켜져 있는 경우
        function checkCapsLock1(event) {
            const capsLockWarning = document.getElementById('caps_lock_warning1');

            const capsLockEnabled = event.getModifierState && event.getModifierState('CapsLock');

            if (capsLockEnabled) {
                capsLockWarning.innerText = 'Caps Lock이 켜져있습니다.';
                capsLockWarning.style.display = 'block';
            } else {
                capsLockWarning.style.display = 'none';
            }
        }

        // 비밀번호 확인 입력 시 Caps Lock이 켜져 있는 경우
        function checkCapsLock2(event) {
            const capsLockWarning = document.getElementById('caps_lock_warning2');

            // event.getModifierState() 함수를 사용하여 Caps Lock 상태 확인
            const capsLockEnabled = event.getModifierState && event.getModifierState('CapsLock');

            if (capsLockEnabled) {
                capsLockWarning.innerText = 'Caps Lock이 켜져있습니다.';
                capsLockWarning.style.display = 'block';
            } else {
                capsLockWarning.style.display = 'none';
            }
        }

        document.getElementById('user_pw').addEventListener('keyup', function() {
            var password = document.getElementById('user_pw').value;

            var hasLetter = /[a-zA-Z]/.test(password);
            var hasNumber = /\d/.test(password);
            var hasSpecialChar = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password);

            if (password.length < 8 || password.length > 20) {
                document.getElementById('su_pw_error').innerText = '8~20자여야 합니다.';
                document.getElementById('su_pw_error').style.display = 'block';
            } else if (hasLetter && hasNumber && hasSpecialChar) {
                document.getElementById('su_pw_error').innerText = '';
                document.getElementById('su_pw_error').style.display = 'none';
            } else {
                document.getElementById('su_pw_error').innerText = '영문, 숫자, 특수문자를 포함해야합니다.';
                document.getElementById('su_pw_error').style.display = 'block';
            }
        });

        document.getElementById('user_pwck').addEventListener('keyup', function() {
            var password = document.getElementById('user_pw').value;
            var confirmPassword = document.getElementById('user_pwck').value;

            if (password === confirmPassword) {
                document.getElementById('su_pwck_error').innerText = '비밀번호가 일치합니다.';
                document.getElementById('su_pwck_error').style.color = 'green';
                document.getElementById('su_pwck_error').style.display = 'block';
            } else {
                document.getElementById('su_pwck_error').innerText = '비밀번호가 일치하지 않습니다.';
                document.getElementById('su_pwck_error').style.color = 'red';
                document.getElementById('su_pwck_error').style.display = 'block';
            }
        });

        document.getElementById('email_domain_txt').disabled = true;
        document.getElementById('email_domain_option').addEventListener('change', function() {
            var selectedOption = this.value;
            var emailDomainTxt = document.getElementById('email_domain_txt');

            if (selectedOption === 'type') {
            emailDomainTxt.value = '';
            emailDomainTxt.disabled = false;
            emailDomainTxt.focus();
            } else {
            emailDomainTxt.value = selectedOption;
            emailDomainTxt.disabled = true;
            }
        });

        document.getElementById('user_email').addEventListener('input', function(event) {
            var input = event.target.value;
            var regex = /^[a-zA-Z0-9!@#$%^&*()\-=+_~`{\[\\}|:;"'<,>.?/]*$/; // 영문, 숫자, 특수 기호를 제외한 문자 입력 방지 정규식
            var errorMessage = document.getElementById('su_email_error');

            if (!regex.test(input)) {
                event.target.value = input.replace(/[^a-zA-Z0-9!@#$%^&*()\-=+_~`{\[\\}|:;"'<,>.?/]/g, '');
                errorMessage.innerText = '영문, 숫자, 특수 기호만 입력할 수 있습니다.';
                errorMessage.style.color = 'red';
                errorMessage.style.display = 'block';
            } else {
                errorMessage.style.display = 'none';
            }
        });

        document.getElementById('email_domain_txt').addEventListener('input', function(event) {
            var input = event.target.value;
            var regex = /^[a-zA-Z.]*$/; // 영어, "." 이외의 문자 입력 방지 정규식
            var errorMessage = document.getElementById('su_email_error');

            if (!regex.test(input)) {
                event.target.value = input.replace(/[^a-zA-Z.]/g, '');
                errorMessage.innerText = '영문, 숫자, 온점(.)만 입력할 수 있습니다.';
                errorMessage.style.color = 'red';
                errorMessage.style.display = 'block';
            } else {
                errorMessage.style.display = 'none';
            }
        });

        document.getElementById('user_number').addEventListener('input', function() {
        var phoneNumber = document.getElementById('user_number').value;
        var formattedNumber = formatPhoneNumber(phoneNumber);
        document.getElementById('user_number').value = formattedNumber;
        });

        function formatPhoneNumber(phoneNumber) {
        phoneNumber = phoneNumber.replace(/[^0-9]/g, ''); // 입력된 문자열에서 숫자 이외의 문자 제거
        var formattedNumber = '';
        if (phoneNumber.length < 4) {
            formattedNumber = phoneNumber;
        } else if (phoneNumber.length < 7) {
            formattedNumber = phoneNumber.substr(0, 3) + '-' + phoneNumber.substr(3);
        } else if (phoneNumber.length < 11) {
            formattedNumber = phoneNumber.substr(0, 3) + '-' + phoneNumber.substr(3, 3) + '-' + phoneNumber.substr(6);
        } else {
            formattedNumber = phoneNumber.substr(0, 3) + '-' + phoneNumber.substr(3, 4) + '-' + phoneNumber.substr(7, 4);
        }
        return formattedNumber;
        }

        document.getElementById('signup_cancel_button').addEventListener('click', function() {
            history.go(-1); // 전 화면으로 돌아가는 동작
        });

        document.getElementById('user_pw').addEventListener('keydown', function(event) {
            if (document.activeElement === document.getElementById('user_pw')) {
                checkCapsLock1(event);
            }
        });

        document.getElementById('user_pwck').addEventListener('keydown', function(event) {
            if (document.activeElement === document.getElementById('user_pwck')) {
                checkCapsLock2(event);
            }
        });

        document.getElementById('user_pw').addEventListener('blur', function() {
            document.getElementById('caps_lock_warning1').style.display = 'none';
        });

        document.getElementById('user_pwck').addEventListener('blur', function() {
            document.getElementById('caps_lock_warning2').style.display = 'none';
        });

        document.getElementById('user_pw').addEventListener('blur', function() {
            document.getElementById('su_pw_error').style.display = 'none';
        });

        document.getElementById('user_pwck').addEventListener('blur', function() {
            document.getElementById('su_pwck_error').style.display = 'none';
        });

  
        function validateForm(event) {
            event.preventDefault();

            const signUpName = document.getElementById('user_name').value;
            const signUpId = document.getElementById('user_id').value;
            const signUpPw = document.getElementById('user_pw').value;
            const signUpPwck = document.getElementById('user_pwck').value;
            const signUpBirthYear = document.querySelector('.field_birth_year select').value;
            const signUpBirthMonth = document.querySelector('.field_birth_month select').value;
            const signUpBirthDay = document.querySelector('.field_birth_day select').value;
            // 이메일
            const signUpEmail = document.getElementById('user_email').value;
            const signUpEmailDomainOption = document.getElementById('email_domain_option').value;
            const signUpEmailDomainTxt = document.getElementById('email_domain_txt').value;
            const signUpNumber = document.getElementById('user_number').value;


            const signUpNameError = document.getElementById('su_name_error');
            const signUpIdError = document.getElementById('su_id_error');
            const signUpPwError = document.getElementById('su_pw_error');
            const signupPwckError = document.getElementById('su_pwck_error');
            const signUpBirthError = document.getElementById('su_birth_error');
            const signUpEmailError = document.getElementById('su_email_error');
            const signUpNumberError = document.getElementById('su_number_error');


            // 이름 유효성 검사
            if (signUpName === '') {
                signUpNameError.innerText = '이름을 입력해주세요.';
                signUpNameError.style.display = 'block';
            } else {
                signUpNameError.style.display = 'none';
            }

            // 아이디 유효성 검사
            if (signUpId === '') {
                signUpIdError.innerText = '아이디를 입력해주세요.';
                signUpIdError.style.display = 'block';
            } else {
                signUpIdError.style.display = 'none';
            }

            // 비밀번호 유효성 검사
            if (signUpPw === '') {
                signUpPwError.innerText = '비밀번호를 입력해주세요.';
                signUpPwError.style.display = 'block';
            } else {
                signUpPwError.style.display = 'none';
            }

            // 비밀번호 확인 유효성 검사
            if (signUpPwck === '') {
                signupPwckError.innerText = '비밀번호를 입력해주세요.';
                signupPwckError.style.display = 'block';
            } else {
                signupPwckError.style.display = 'none';
            }

            // 생년월일 유효성 검사
            if (signUpBirthYear === '출생년도' || signUpBirthMonth === '월' || signUpBirthDay === '일') {
                signUpBirthError.innerText = '생년월일을 선택해주세요.';
                signUpBirthError.style.display = 'block';
            } else {
                signUpBirthError.style.display = 'none';
            }

            // 이메일 유효성 검사
            if (signUpEmail === '' || (signUpEmailDomainOption === 'type' && signUpEmailDomainTxt === '')) {
                signUpEmailError.innerText = '이메일을 입력해주세요.';
                signUpEmailError.style.display = 'block';
            } else {
                    signUpEmailError.style.display = 'none';
            }

            // 전화번호 유효성 검사
            if (signUpNumber === '') {
                signUpNumberError.innerText = '전화번호를 입력해주세요.';
                signUpNumberError.style.display = 'block';
            } else {
                signUpNumberError.style.display = 'none';
            }
        }

        // 회원 가입 처리 함수
        function signUp(userName, userId, userPw, userEmail, userPhone) {
            // 회원 가입 로직 작성

            // 회원 가입 성공 시 결과 출력
            var isSuccess = true;
            if (isSuccess) {
                alert("회원 가입이 완료되었습니다.");
            } else {
                alert("회원 가입에 실패했습니다. 다시 시도해주세요.");
            }
        }

        document.getElementById('signup_button').addEventListener('click', validateForm);


    </script>
</body>
</html>
